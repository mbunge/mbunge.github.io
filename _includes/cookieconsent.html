<script src="{{ "/js/cookieconsent.js" | prepend: site.baseurl }}" rel="preload" as="script"></script>
    <script>
        const individualHasConsentedName = 'individualHasConsented';
        function createCookieConsentEvent(consent) {
            return new CustomEvent('app:cookieConsent', {consent: consent});
        }
        window.addEventListener('storage', function(ev) {
            if(ev.key === individualHasConsentedName) {
                window.dispatchEvent(createCookieConsentEvent(ev.newValue === 'y'))
            }
        });
        window.cookieconsent.initialise({
            cookie: {
                domain: page.url
            },
         revokable:true,
         onStatusChange: function(status) {
            window.dispatchEvent(createCookieConsentEvent(this.hasConsented()))
          if(this.hasConsented()) {
            window.localStorage.setItem(individualHasConsentedName, 'y');
          } else {
            window.localStorage.removeItem(individualHasConsentedName);
          }
         }
        });
       </script>